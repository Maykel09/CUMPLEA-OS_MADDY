<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Carta para Maddy</title>
  <style>
    body {
      margin: 0;
      font-family: 'Comic Sans MS', cursive;
      background: #000;
      background-image:
        radial-gradient(2px 2px at 20px 30px, white, transparent),
        radial-gradient(2px 2px at 50px 70px, white, transparent),
        radial-gradient(2px 2px at 80px 90px, white, transparent),
        radial-gradient(2px 2px at 120px 50px, white, transparent),
        radial-gradient(2px 2px at 150px 80px, white, transparent);
      background-repeat: repeat;
      background-size: 200px 200px;
      text-align: center;
      overflow: hidden;
    }

    #contadorFecha {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: clamp(40px, 10vw, 100px);
      font-weight: bold;
      color: #ff1493;
      user-select: none;
      z-index: 5;
      opacity: 1;
      transition: opacity 1s ease;
    }

    @keyframes pop {
      0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; }
      50% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
      100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
    }

    .portada, .contenido {
      height: 100vh;
      width: 100vw;
      position: absolute;
      top: 0;
      left: 0;
    }

    .portada {
      background: linear-gradient(to top right, #ffb6c1, #ffc0cb);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 3;
      opacity: 0;
      pointer-events: none;
      transition: opacity 1s ease;
    }

    .portada.visible { opacity: 1; pointer-events: auto; }

    .portada h1 {
      font-size: 48px;
      color: #8b008b;
    }

    .boton {
      margin-top: 20px;
      padding: 15px 30px;
      font-size: 20px;
      background-color: #ff69b4;
      border: none;
      border-radius: 20px;
      color: white;
      cursor: pointer;
      transition: 0.3s;
    }

    .boton:hover { background-color: #ff1493; }

    .contenido {
      background: linear-gradient(to top right, #ffe0f0, #fff8fb);
      color: #8b008b;
      padding: 40px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transform: scale(0.8);
      pointer-events: none;
      transition: opacity 1s ease, transform 1s ease;
      z-index: 2;
    }

    .contenido.visible {
      opacity: 1;
      transform: scale(1);
      pointer-events: auto;
    }

    #tituloAnimado {
      font-size: 60px;
      white-space: pre;
      min-height: 80px;
    }

    .linea {
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 1s ease, transform 1s ease;
      font-size: 24px;
      margin-top: 10px;
      max-width: 700px;
    }

    .linea.show { opacity: 1; transform: translateY(0); }

    img {
      max-width: 300px;
      margin-top: 20px;
      border-radius: 20px;
      box-shadow: 0 0 20px pink;
      opacity: 0;
      transform: translateY(20px);
      transition: 1s ease;
    }

    img.show { opacity: 1; transform: translateY(0); }

    .footer {
      margin-top: 40px;
      font-size: 18px;
      color: #4b0082;
      opacity: 0;
      transform: translateY(20px);
      transition: 1s ease;
    }

    .footer.show { opacity: 1; transform: translateY(0); }

    .balloon {
      position: absolute;
      width: 60px;
      height: 80px;
      border-radius: 50%;
      animation: float 6s linear infinite;
      opacity: 0.8;
    }

    .balloon::after {
      content: "";
      position: absolute;
      width: 2px;
      height: 40px;
      background: #aaa;
      top: 80px;
      left: 50%;
      transform: translateX(-50%);
    }

    @keyframes float {
      0% { bottom: -100px; transform: translateX(0); }
      100% { bottom: 110%; transform: translateX(-20px); }
    }

    .b1 { left: 10%; background-color: #ff6f91; animation-delay: 0s; }
    .b2 { left: 30%; background-color: #ffc75f; animation-delay: 2s; }
    .b3 { left: 50%; background-color: #845ec2; animation-delay: 4s; }
    .b4 { left: 70%; background-color: #00c9a7; animation-delay: 1s; }
    .b5 { left: 90%; background-color: #f9f871; animation-delay: 3s; }

    #lluvia {
      position: absolute;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      pointer-events: none;
      overflow: hidden;
      z-index: 4;
      background: transparent;
    }

    .texto-lluvia {
      position: absolute;
      font-size: 24px;
      font-weight: bold;
      user-select: none;
      animation-name: caer;
      animation-timing-function: linear;
      animation-iteration-count: 1;
      pointer-events: none;
      opacity: 1;
    }

    @keyframes caer {
      0% { top: -30px; opacity: 1; }
      90% { opacity: 1; }
      100% { top: 110vh; opacity: 0; }
    }
  </style>
</head>
<body>

  <div id="contadorFecha"></div>
  <div id="lluvia"></div>

  <div class="portada" id="portada">
    <h1>ðŸ’Œ Para Maddy, con cariÃ±o</h1>
    <button class="boton" onclick="abrirCarta()">Abrir carta</button>
  </div>

  <div class="contenido" id="contenido">
    <div class="balloon b1"></div>
    <div class="balloon b2"></div>
    <div class="balloon b3"></div>
    <div class="balloon b4"></div>
    <div class="balloon b5"></div>

    <h1 id="tituloAnimado"></h1>

    <div class="linea" id="l1">Hoy celebramos a una persona muy especial ðŸ’–</div>
    <div class="linea" id="l2">Espero que hoy tengas un gran dÃ­a, lleno de buenos momentos y rodeada de la gente que te quiere.</div>
    <div class="linea" id="l3">Te mereces lo mejor en este nuevo aÃ±o de vida.</div>
    <div class="linea" id="l4">Â¡A seguir cumpliendo metas y disfrutando cada momento! ðŸ’«</div>

    <img id="imagen" src="https://i.pinimg.com/736x/58/c7/ae/58c7ae3e6d438584dad7a5d06bf0c543.jpg" alt="Torta de cumpleaÃ±os decorada con velas" />

    <div class="footer" id="firma">
      Con todo mi cariÃ±o,<br />ðŸ’Œ
    </div>

    <!-- MÃºsica -->
    <audio id="musica" loop>
      <source src="https://cdn.pixabay.com/download/audio/2025/04/30/audio_9834479b67.mp3?filename=happy-birthday-334876.mp3" type="audio/mpeg" />
      Tu navegador no soporta audio HTML5.
    </audio>
  </div>

  <script>
    const contadorFechaDiv = document.getElementById('contadorFecha');
    const lluvia = document.getElementById('lluvia');
    const portada = document.getElementById('portada');
    const contenido = document.getElementById('contenido');

    let lluviaInterval;
    const textoLluvia = "Feliz CumpleaÃ±os Maddy";

    function animarContador(callback) {
      const numeros = ['3', '2', '1'];
      let index = 0;

      function mostrarNumero() {
        if (index < numeros.length) {
          contadorFechaDiv.textContent = numeros[index];
          contadorFechaDiv.style.animation = 'none';
          void contadorFechaDiv.offsetWidth;
          contadorFechaDiv.style.animation = 'pop 0.8s ease forwards';
          index++;
          setTimeout(mostrarNumero, 1000);
        } else {
          callback();
        }
      }
      mostrarNumero();
    }

    function mostrarFecha(callback) {
      contadorFechaDiv.textContent = '26/08/2025';
      contadorFechaDiv.style.animation = 'none';
      void contadorFechaDiv.offsetWidth;
      contadorFechaDiv.style.animation = 'pop 1s ease forwards';
      setTimeout(callback, 2000);
    }

    function iniciarLluvia() {
      let index = 0;
      const colores = ['#ff1493', '#ff69b4', '#ffc0cb', '#ff6f91', '#f9f871', '#00c9a7', '#845ec2'];

      lluviaInterval = setInterval(() => {
        if (index >= textoLluvia.length) index = 0;
        const letra = textoLluvia.charAt(index);
        if (letra === ' ') { index++; return; }

        const span = document.createElement('span');
        span.textContent = letra;
        span.classList.add('texto-lluvia');
        span.style.color = colores[Math.floor(Math.random() * colores.length)];
        span.style.left = Math.random() * (window.innerWidth - 20) + 'px';
        const duracion = 6000 + Math.random() * 4000;
        span.style.animationDuration = duracion + 'ms';
        span.style.fontSize = (20 + Math.random() * 8) + 'px';
        lluvia.appendChild(span);

        setTimeout(() => { if (lluvia.contains(span)) lluvia.removeChild(span); }, duracion);
        index++;
      }, 1);
    }

    function detenerLluvia() {
      clearInterval(lluviaInterval);
      lluvia.innerHTML = '';
    }

    function mostrarPortada() {
      detenerLluvia();
      contadorFechaDiv.style.opacity = '0';
      setTimeout(() => {
        contadorFechaDiv.style.display = 'none';
        portada.classList.add('visible');
      }, 1000);
    }

    window.onload = () => {
      animarContador(() => {
        mostrarFecha(() => {
          iniciarLluvia();
          setTimeout(mostrarPortada, 14000);
        });
      });
    };

    function abrirCarta() {
      portada.style.opacity = '0';
      setTimeout(() => {
        portada.style.display = 'none';
        contenido.classList.add('visible');
        escribirTitulo("ðŸŽ‚ Â¡Feliz CumpleaÃ±os Maddy! ðŸŽ‰");

        // reproducir mÃºsica al abrir la carta
        const musica = document.getElementById("musica");
        musica.currentTime = 0;
        musica.volume = 0.10;
        musica.play().catch(err => console.log("Autoplay bloqueado:", err));
      }, 1000);
    }

    function escribirTitulo(texto) {
      const elemento = document.getElementById("tituloAnimado");
      elemento.textContent = "";
      let i = 0;
      const intervalo = setInterval(() => {
        elemento.textContent += texto.charAt(i);
        i++;
        if (i >= texto.length) { clearInterval(intervalo); animarLineas(); }
      }, 100);
    }

    function animarLineas() {
      const delay = 600;
      const lineas = ['l1', 'l2', 'l3', 'l4'];
      lineas.forEach((id, index) => {
        setTimeout(() => { document.getElementById(id).classList.add('show'); }, delay * index);
      });
      setTimeout(() => {
        document.getElementById("imagen").classList.add("show");
        document.getElementById("firma").classList.add("show");
      }, delay * lineas.length + 500);
    }
  </script>
</body>
</html>
